<ol class="breadcrumb">
  <li><a href="/" data-navigation>Top</a></li>
  <li class="active">Datasets</li>
</ol>

<div class="well well-sm dsmoq-filter" id="conditions">
  <div class="row">
    <div class="col-md-12">
      <div class="input-group" style="float:left; width: 400px;">
		<form id="search-form">
			<input type="text" class="form-control" placeholder="query" data-link="condition.query">
		</form>
        <span class="input-group-btn">
          <button class="btn btn-primary" type="button" id="search-button"><span class="glyphicon glyphicon-search"></span></button>
        </span>
      </div>
      <button id="add-filter-button" class="btn btn-default" style="margin-left: 8px;"><span class="glyphicon glyphicon-plus"></span> Filter</button>
    </div>
  </div>
  {^{if condition.filters.length > 0}}
    <div class="row">
      <div class="col-md-12">
        <ul class="list-group">
          {^{for condition.filters}}
            {{if (type == "owner")}}
              <li class="list-group-item list-group-item-success">
                <span class="glyphicon glyphicon-user"></span>{{>item.name}} {{if item.dataType==1}}({{>item.fullname}}){{/if}}
                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></button>
              </li>
            {{else}}
              <li class="list-group-item list-group-item-info">
                <span class="glyphicon glyphicon-tag"></span> {{>item.name}} = {{>item.value}}
                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></button>
              </li>
            {{/if}}
          {{/for}}
          <li class="list-group-item" style="padding: 0; border-width: 0;"></li>
        </ul>
      </div>
    </div>
  {{/if}}

  <div style="display:none" id="filter-add-form">
    <ul class="nav nav-tabs" role="tablist">
      <li class="active"><a role="tab" data-toggle="tab" href="#filter-owner-tab"><span class="glyphicon glyphicon-user"></span> Owner</a></li>
      <li><a role="tab" data-toggle="tab" href="#filter-attribute-tab"><span class="glyphicon glyphicon-tag"></span> Attribute</a></li>
    </ul>
    <div class="tab-content" style="width: 280px;">
      <div class="tab-pane active" id="filter-owner-tab">
        <div class="form-group">
          <input type="text" class="form-control" id="filter-owner-input" placeholder="Enter owner">
        </div>
        <div class="form-group">
          <button type="button" class="btn btn-primary" id="filter-owner-apply" disabled>Apply</button>
        </div>
      </div>
      <div class="tab-pane" id="filter-attribute-tab">
        <div class="form-group">
          <input type="text" class="form-control" id="filter-attribute-name-input" placeholder="Enter name">
        </div>
        <div class="form-group">
          <input type="text" class="form-control" id="filter-attribute-value-input" placeholder="Enter value">
        </div>
        <div class="form-group">
          <button type="button" class="btn btn-primary" id="filter-attribute-apply" disabled>Apply</button>
        </div>
      </div>
    </div>
  </div>
</div>

{^{async result ~condition=condition ~tag=tag}}
  {^{if total > 0}}
    <p><strong>Found {^{>total}} records</strong></p>
    <ul class="media-list dataset-list">
      {^{for items}}
        <li class="media">
          <div class="pull-left" style="width: 96px; text-align: center;">
            <a class="media-left" href="#"><img src="{{>image+'/96'}}"srcset="{{>image+'/96'}} 1x, {{>image+'/192'}} 2x" alt="{{>name}}" /></a>
          </div>
          <div class="media-body">
            <h4 class="media-heading"><a href="/datasets/{{>id}}" data-navigation>{{>name}}</a></h4>
            <p class="dataset-description-list">{{if ~trimTags(description)}}{{:~trimTags(description)}}{{else}}<span class="text-muted">(No description)</span>{{/if}}</p>
            <div>
              {{for ownerships ~length=ownerships.length}}
                <span class="label label-success">
                  <span class="glyphicon glyphicon-user"></span>
                  {{if ownerType == 1}} {{>fullname}} {{else}} {{>name}} {{/if}}
                </span>&nbsp;
              {{/for}}
            </div>
            <div>
              <span class="label label-default">{{>files}} files ({{datasize dataSize /}})</span>&nbsp;
              {{for attributes}}
				{{if value=="$tag"}}
				<span class="label label-info" style="background-color: {{: ~getTagColor(~tag)(name)}}"><span class="glyphicon glyphicon-tag"></span> {{>name}}</span>
				{{/if}}
              {{/for}}
            </div>
          </div>
        </li>
      {{/for}}
    </ul>
    {^{pagination ~condition.index pages id="dataset-pagination" pagedelta=5 /}}
  {{else}}
     <p>There are no datasets.</p>
  {{/if}}
{{/async}}
