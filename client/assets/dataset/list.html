<ol class="breadcrumb">
  <li><a href="/">Top</a></li>
  <li class="active">Dataset List</li>
</ol>

<div class="well well-sm dsmoq-filter" id="conditions">
  <div class="row">
    <div class="col-md-12">
      <div class="input-group" style="float:left; width: 400px;">
        <input type="text" class="form-control" placeholder="query" data-link="condition.query">
        <span class="input-group-btn">
          <button class="btn btn-primary" type="button" id="search-button"><span class="glyphicon glyphicon-search"></span></button>
        </span>
      </div>
      <button id="add-filter-button" class="btn btn-default" style="margin-left: 8px;"><span class="glyphicon glyphicon-plus"></span> Filter</button>
    </div>
  </div>
  {^{if condition.filters.length > 0}}
    <div class="row">
      <div class="col-md-12">
        <ul class="list-group">
          {^{for condition.filters}}
            {{if (type == "owner") ~index=#index}}
              <li class="list-group-item list-group-item-success" data-index="{{>~index}}">
                <span class="glyphicon glyphicon-user"></span>{{>item.name}} {{if item.dataType==1}}({{>item.fullname}}){{/if}}
                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></button>
              </li>
            {{else ~index=#index}}
              <li class="list-group-item list-group-item-info" data-index="{{>~index}}">
                <span class="glyphicon glyphicon-tag"></span> {{>item.name}} = {{>item.value}}
                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></button>
              </li>
            {{/if}}
          {{/for}}
          <li class="list-group-item" style="padding: 0; border-width: 0;"></li>
        </ul>
      </div>
    </div>
  {{/if}}

  <div style="display:none" id="filter-add-form">
    <ul class="nav nav-tabs" role="tablist">
      <li class="active"><a role="tab" data-toggle="tab" href="#filter-owner-tab"><span class="glyphicon glyphicon-user"></span> Owner</a></li>
      <li><a role="tab" data-toggle="tab" href="#filter-attribute-tab"><span class="glyphicon glyphicon-tag"></span> Attribute</a></li>
    </ul>
    <div class="tab-content" style="width: 280px;">
      <div class="tab-pane active" id="filter-owner-tab">
        <div class="form-group">
          <input type="text" class="form-control" id="filter-owner-input" placeholder="Enter owner">
        </div>
        <div class="form-group">
          <button type="button" class="btn btn-primary" id="filter-owner-apply" disabled>Apply</button>
        </div>
      </div>
      <div class="tab-pane" id="filter-attribute-tab">
        <div class="form-group">
          <input type="text" class="form-control" id="filter-attribute-name-input" placeholder="Enter name">
        </div>
        <div class="form-group">
          <input type="text" class="form-control" id="filter-attribute-value-input" placeholder="Enter value">
        </div>
        <div class="form-group">
          <button type="button" class="btn btn-primary" id="filter-attribute-apply" disabled>Apply</button>
        </div>
      </div>
    </div>
  </div>
</div>

{^{async result ~condition=condition}}
  {^{if total > 0}}
    <strong>Found {^{>total}} records</strong>
    <ul>
      {^{for items}}
        <li class="dataset-item">
          <div class="row">
            <div class="pull-left">
              {{a href="/datasets/"+id}}{{img src=image class="img-thumbnail"/}}{{/a}}
            </div>
            <div class="result-list-body">
              <h3>{{a href="/datasets/"+id}}{{>name}}{{/a}} <span>{{>files}} files({{datasize dataSize /}})</span></h3>
              <p>{{>description}}</p>
              <p>
                Owner:
                <span>Owner:</span>
                {{for ownerships}}
                  <strong>{{>fullname}}</strong>
                  {{if #index == (#parent.length - 1)}}, {{/if}}
                {{/for}}
                <span class="meta-data text-muted">
                  {{for attributes}}
                    <span>{{>name}}: {{>value}}</span>
                    {{if #index == (#parent.length - 1)}}, {{/if}}
                  {{else}}
                    No attributes
                  {{/for}}
                </span>
              </p>
            </div>
          </div>
        </li>
      {{/for}}
    </ul>
    {^{pagination ~condition.index pages id="dataset-pagination" pagedelta=5 /}}
  {{else}}
     <p>There are no datasets.</p>
  {{/if}}
{{/async}}